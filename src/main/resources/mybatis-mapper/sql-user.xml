<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.anesi.mapper.LoginMapper">

	<update id="userJoin" parameterType="hashmap">
		INSERT INTO A_TBL_USER(USER_EMAIL, USER_PWD, PHONE, NICK, USER_NAME, BIRTHDAY, GENDER) 
		VALUES(#{userEmail1}+#{userEmail2},#{pw1}, #{phone}, #{nick}, #{userName}, #{bYear}+
		<if test="10 > bMonth">
			'0'+#{bMonth}
		</if>
		<if test="bMonth > 10">
			#{bMonth}
		</if>
		<if test="10 > bDay">
			+'0'+#{bDay}
		</if>
		<if test="bDay > 10">
			+#{bDay}
		</if>
		, #{gender}, #{smsYn})
	</update>
	<!-- 로그인 쿼리 -->
	<select id="selectUser" parameterType="hashmap" resultType="com.example.anesi.model.User">
		SELECT * 
		FROM t3_TBL_USER
		WHERE USER_EMAIL = #{userEmail} AND USER_PWD = #{pwd}
	</select>
	<!-- 로그인 아이디 확인 -->
	<select id="userCheckId" parameterType="hashmap" resultType="com.example.anesi.model.User">
		select *
		from t3_tbl_user
		where USER_EMAIL = #{userEmail}
	</select>
	<!-- 로그인 실패 횟수 증가 -->
	<update id="updateCnt" parameterType="hashmap">
		update t3_tbl_user
		set
		cnt = cnt + 1
		where USER_EMAIL = #{userEmail}
	</update>
	<!-- 로그인 실패 횟수 초기화 -->
	<update id="reSetCnt" parameterType="hashmap">
		update t3_tbl_user
		set
		cnt = 0
		where USER_EMAIL = #{userEmail}
	</update>	
</mapper>